{"version":3,"file":"utils.js","names":["computed","toRef","toValue","clamp","roundedArc","simpleArc","formatTextTemplate","template","item","replaceAll","title","String","value","undefined","usePieArc","props","isHovering","hoverZoomRatio","Number","hoverScale","normalizedValue","gap","normalizedInnerCut","min","rounded","innerCut","radians","Math","PI","arcWidth","outerX","cos","outerY","sin","useOuterSlicePath","_ref","angle","radius","size","width","useInnerSlicePath","_ref2"],"sources":["../../../src/labs/VPie/utils.ts"],"sourcesContent":["// Utilities\nimport { computed, toRef, toValue } from 'vue'\nimport { clamp } from '@/util'\nimport { roundedArc, simpleArc } from '@/util/svg-arc-corners'\n\n// Types\nimport type { MaybeRefOrGetter, Ref } from 'vue'\nimport type { PieItem, PieSegmentProps } from './types'\n\nexport function formatTextTemplate (template: string, item?: PieItem) {\n  return item\n    ? template\n      .replaceAll('[title]', item.title)\n      .replaceAll('[value]', String(item.value))\n    : undefined\n}\n\nexport function usePieArc (props: PieSegmentProps, isHovering: Ref<boolean>) {\n  const hoverZoomRatio = toRef(() => clamp(Number(props.hoverScale ?? 0), 0, 0.25))\n  const normalizedValue = toRef(() => clamp(props.value - 100 * Number(props.gap ?? 0) / 360, 0.01, 99.99))\n  const normalizedInnerCut = toRef(() => {\n    const min = Number(props.rounded ?? 0) > 0 ? 0.2 : 0\n    return clamp(Number(props.innerCut ?? 0) / 100, min, 1)\n  })\n\n  const radians = computed(() => (360 * (-normalizedValue.value / 100) + 90) * (Math.PI / 180))\n  const arcWidth = computed(() => 50 * (1 - normalizedInnerCut.value) * (isHovering.value ? 1 : (1 - hoverZoomRatio.value)))\n\n  const outerX = toRef(() => 50 + 50 * Math.cos(radians.value))\n  const outerY = toRef(() => 50 - 50 * Math.sin(radians.value))\n\n  return {\n    hoverZoomRatio,\n    normalizedValue,\n    normalizedInnerCut,\n    outerX,\n    outerY,\n    arcWidth,\n  }\n}\n\nexport function useOuterSlicePath ({\n  angle,\n  radius,\n  size,\n  width,\n  rounded,\n}: {\n  angle: MaybeRefOrGetter<number>\n  radius: MaybeRefOrGetter<number>\n  size: MaybeRefOrGetter<number>\n  width: MaybeRefOrGetter<number>\n  rounded: MaybeRefOrGetter<number>\n}) {\n  return computed(() =>\n    roundedArc(\n      [50, 50],\n      toValue(radius),\n      toValue(angle),\n      toValue(angle) + 360 * toValue(size) / 100, // angle end,\n      toValue(width),\n      toValue(rounded),\n    )\n  )\n}\n\nexport function useInnerSlicePath ({\n  angle,\n  radius,\n  size,\n}: {\n  angle: MaybeRefOrGetter<number>\n  radius: MaybeRefOrGetter<number>\n  size: MaybeRefOrGetter<number>\n}) {\n  return computed(() =>\n    simpleArc(\n      [50, 50],\n      toValue(radius),\n      toValue(angle),\n      toValue(angle) + 360 * toValue(size) / 100, // angle end,\n    )\n  )\n}\n"],"mappings":"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","ignoreList":[]}