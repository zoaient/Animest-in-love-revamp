{"version":3,"file":"VPieSegment.js","names":["useProxiedModel","makeRevealProps","useReveal","computed","toRef","useInnerSlicePath","useOuterSlicePath","usePieArc","easingPatterns","genericComponent","propsFactory","useTransition","makeVPieSegmentProps","active","Boolean","rotate","Number","String","value","type","default","color","innerCut","hoverScale","gap","rounded","animation","Object","pattern","hideSlice","VPieSegment","name","props","emits","val","setup","isActive","state","revealState","duration","revealDuration","transitionConfig","defaultEasing","defaultDuration","easingName","easing","includes","transition","hoverZoomRatio","normalizedValue","normalizedInnerCut","outerX","outerY","arcWidth","arcSize","currentArcSize","angle","currentAngle","arcRadius","currentArcRadius","currentArcWidth","outerSlicePath","radius","size","width","innerSlicePath","overlayPath","_createElementVNode","onMouseenter","onMouseleave"],"sources":["../../../src/labs/VPie/VPieSegment.tsx"],"sourcesContent":["// Composables\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { makeRevealProps, useReveal } from '@/composables/reveal'\n\n// Utilities\nimport { computed, toRef } from 'vue'\nimport { useInnerSlicePath, useOuterSlicePath, usePieArc } from './utils'\nimport { easingPatterns, genericComponent, propsFactory, useTransition } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\n\nexport const makeVPieSegmentProps = propsFactory({\n  active: Boolean,\n  rotate: [Number, String],\n  value: {\n    type: Number,\n    default: 0,\n  },\n  color: String,\n  innerCut: [Number, String],\n  hoverScale: {\n    type: [Number, String],\n    default: 0.05,\n  },\n  gap: [Number, String],\n  rounded: [Number, String],\n  animation: {\n    type: [Boolean, Object] as PropType<boolean | {\n      duration?: number\n      easing?: keyof typeof easingPatterns\n    }>,\n    default: false,\n  },\n  pattern: String,\n  hideSlice: Boolean,\n  ...makeRevealProps(),\n}, 'VPieSegment')\n\nexport const VPieSegment = genericComponent()({\n  name: 'VPieSegment',\n\n  props: makeVPieSegmentProps(),\n\n  emits: {\n    'update:active': (val: boolean) => true,\n  },\n\n  setup (props) {\n    const isActive = useProxiedModel(props, 'active')\n\n    const { state: revealState, duration: revealDuration } = useReveal(props)\n\n    const transitionConfig = computed(() => {\n      const defaultEasing = 'easeInOutCubic'\n      const defaultDuration = 400\n\n      const easingName = typeof props.animation === 'object'\n        ? props.animation.easing ?? defaultEasing\n        : defaultEasing\n\n      return {\n        duration: ['initial', 'pending'].includes(revealState.value)\n          ? revealDuration.value\n          : typeof props.animation === 'object'\n            ? props.animation.duration\n            : (props.animation ? defaultDuration : 0),\n        transition: easingPatterns[easingName],\n      }\n    })\n\n    const {\n      hoverZoomRatio,\n      normalizedValue,\n      normalizedInnerCut,\n      outerX,\n      outerY,\n      arcWidth,\n    } = usePieArc(props, isActive)\n\n    const arcSize = toRef(() => revealState.value === 'initial' ? 0 : normalizedValue.value)\n    const currentArcSize = useTransition(arcSize, transitionConfig)\n\n    const angle = toRef(() => revealState.value === 'initial' ? 0 : (Number(props.rotate ?? 0) + Number(props.gap ?? 0) / 2))\n    const currentAngle = useTransition(angle, transitionConfig)\n\n    const arcRadius = toRef(() => 50 * (isActive.value ? 1 : (1 - hoverZoomRatio.value)))\n    const currentArcRadius = useTransition(arcRadius, transitionConfig)\n    const currentArcWidth = useTransition(arcWidth, transitionConfig)\n\n    const outerSlicePath = useOuterSlicePath({\n      angle: currentAngle,\n      radius: currentArcRadius,\n      size: currentArcSize,\n      width: currentArcWidth,\n      rounded: () => Number(props.rounded ?? 0),\n    })\n\n    const innerSlicePath = useInnerSlicePath({\n      angle: currentAngle,\n      radius: () => currentArcRadius.value - currentArcWidth.value,\n      size: currentArcSize,\n    })\n\n    const overlayPath = toRef(() => `M 50 0 A 50 50 0 ${normalizedValue.value > 50 ? 1 : 0} 1 ${outerX.value} ${outerY.value} L 50 50`)\n\n    return () => (\n      <g\n        class=\"v-pie-segment\"\n        style={{ color: props.color }}\n      >\n        <path\n          key=\"outer-slice\"\n          fill=\"currentColor\"\n          shape-rendering=\"geometricPrecision\"\n          d={ outerSlicePath.value }\n        />\n        { props.pattern && (\n          <path\n            key=\"pattern-overlay\"\n            shape-rendering=\"geometricPrecision\"\n            fill={ props.pattern }\n            d={ outerSlicePath.value }\n          />\n        )}\n        { !props.hideSlice && normalizedInnerCut.value > 0 && (\n          <path\n            key=\"inner-slice\"\n            fill=\"oklch(from currentColor l c h / calc(alpha / 2))\"\n            d={ innerSlicePath.value }\n          />\n        )}\n        {['disabled', 'done'].includes(revealState.value) && (\n          <path\n            transform={ `rotate(${currentAngle.value} 50 50)` }\n            class=\"v-pie-segment__overlay\"\n            d={ overlayPath.value }\n            onMouseenter={ () => isActive.value = true }\n            onMouseleave={ () => isActive.value = false }\n          />\n        )}\n      </g>\n    )\n  },\n})\n\nexport type VPieSegment = InstanceType<typeof VPieSegment>\n"],"mappings":"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","ignoreList":[]}