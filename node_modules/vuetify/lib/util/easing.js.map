{"version":3,"file":"easing.js","names":["computed","shallowRef","toValue","watch","clamp","standardEasing","deceleratedEasing","acceleratedEasing","easingPatterns","linear","t","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","useTransition","source","options","defaultTransition","duration","transition","raf","outputRef","to","cancelAnimationFrame","easing","executeTransition","value","out","from","startTime","performance","now","ease","Promise","resolve","requestAnimationFrame","step","currentTime","timeElapsed","progress"],"sources":["../../src/util/easing.ts"],"sourcesContent":["// Utilities\nimport { computed, shallowRef, toValue, watch } from 'vue'\nimport { clamp } from './helpers'\n\n// Types\nimport type { MaybeRefOrGetter, Ref } from 'vue'\n\nexport const standardEasing = 'cubic-bezier(0.4, 0, 0.2, 1)'\nexport const deceleratedEasing = 'cubic-bezier(0.0, 0, 0.2, 1)' // Entering\nexport const acceleratedEasing = 'cubic-bezier(0.4, 0, 1, 1)' // Leaving\n\nexport type EasingFunction = (n: number) => number\n\nexport const easingPatterns = {\n  linear: (t: number) => t,\n  easeInQuad: (t: number) => t ** 2,\n  easeOutQuad: (t: number) => t * (2 - t),\n  easeInOutQuad: (t: number) => (t < 0.5 ? 2 * t ** 2 : -1 + (4 - 2 * t) * t),\n  easeInCubic: (t: number) => t ** 3,\n  easeOutCubic: (t: number) => --t ** 3 + 1,\n  easeInOutCubic: (t: number) => t < 0.5 ? 4 * t ** 3 : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n  easeInQuart: (t: number) => t ** 4,\n  easeOutQuart: (t: number) => 1 - --t ** 4,\n  easeInOutQuart: (t: number) => (t < 0.5 ? 8 * t ** 4 : 1 - 8 * --t ** 4),\n  easeInQuint: (t: number) => t ** 5,\n  easeOutQuint: (t: number) => 1 + --t ** 5,\n  easeInOutQuint: (t: number) => t < 0.5 ? 16 * t ** 5 : 1 + 16 * --t ** 5,\n} as const\n\nexport type EasingOptions = {\n  duration?: number\n  transition?: EasingFunction\n}\n\ntype InternalEasingOptions = {\n  duration: number\n  transition: EasingFunction\n}\n\nexport function useTransition (source: MaybeRefOrGetter<number>, options: MaybeRefOrGetter<EasingOptions>) {\n  const defaultTransition: InternalEasingOptions = {\n    duration: 300,\n    transition: easingPatterns.easeInOutCubic,\n  }\n\n  let raf = -1\n  const outputRef = shallowRef(toValue(source))\n\n  watch(() => toValue(source), async to => {\n    cancelAnimationFrame(raf)\n    const easing = { ...defaultTransition, ...toValue(options) }\n    await executeTransition(outputRef, outputRef.value, to, easing)\n  })\n\n  function executeTransition (out: Ref<number>, from: number, to: number, options: InternalEasingOptions) {\n    const startTime = performance.now()\n    const ease = options.transition ?? easingPatterns.easeInOutCubic\n\n    return new Promise<void>(resolve => {\n      raf = requestAnimationFrame(function step (currentTime: number) {\n        const timeElapsed = currentTime - startTime\n        const progress = timeElapsed / options.duration\n        out.value = from + (to - from) * ease(clamp(progress, 0, 1))\n\n        if (progress < 1) {\n          raf = requestAnimationFrame(step)\n        } else {\n          out.value = to\n          resolve()\n        }\n      })\n    })\n  }\n\n  return computed(() => outputRef.value)\n}\n"],"mappings":"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","ignoreList":[]}